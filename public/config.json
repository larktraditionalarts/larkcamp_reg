{
    "uiSchema": {
        "ui:description": { "__html": "<p>Please read <a href='http://www.larkcamp.org/campterms.html' target='_blank'>Terms of Registration</a> before filling out this form.</p><p>Fill out this form to complete your registration for Lark Camp 2020 online. Please note that registrations are accepted in the order they are received; your camping preferences are processed on a “first come - first served” basis. Your early payment will not be cashed or charged until January 2020.</p><p><strong>Registering by Mail</strong></p><p>If you do not wish to register online, you can download a four-page PDF Registration Form to hand-fill at:<br><a href='http://www.larkcamp.org/regform.pdf' target='_blank'>2020 Mail In Registration Form</a><br>Mail your form with your credit card information, PayPal email address for invoicing, or a check, cashier's check, or money order payable to “Lark Camp” to:<br>Lark Camp Registration, PO Box 1724, Mendocino, CA 95460</p><p>Fields marked with an asterisk (*) are required.</p><p><strong>There are no refunds</strong>; please consider purchasing trip insurance if you know something could prevent your attendance.</p>" },
        "payer_billing_address": {
            "ui:title": "Billing Address",
            "contentClassNames": "row",
            "street_address":       { "classNames": "col-xs-12 col-sm-12" },
            "city":                 { "classNames": "col-xs-12 col-sm-12"  },
            "state_or_province":    { "classNames": "col-xs-6  col-sm-6"  },
            "zip_code":             { "classNames": "col-xs-6  col-sm-6"  },
            "country":              { "classNames": "col-xs-12 col-sm-6"  }
        },
        "payer_number": {
            "ui:widget": "PhoneInput"
        },
        "payment_type": {
            "ui:description": { "__html": "<p>Full Price - payment by credit card or PayPal</p><p>Discount price - payment by personal check, cashier's check, or money order (Please note that any balance payments must be made by the same method.)</p>" }
        },
        "parking_passes": {
            "ui:description": { "__html": "<p>The Mendocino Woodlands asks us to carpool when possible to reduce the number of cars in the State Park. <a href='https://www.larkcamp.org/carpool.html' target='_blank'>Go to larkcamp.org to find out about sharing rides.</a></p><p><strong>ALL vehicles and trailers are required to have a parking pass.</strong><br><u>Mendocino Woodlands vehicle requirements:</u> If you have a car AND a trailer, you will need two (2) parking passes. If your vehicle, or combined vehicle and trailer, is over 20 feet long, call to ensure there is available space <u>before</u> you register.</p><ul><li>You can pre-purchase parking passes for a discounted price of $60 (full price = $62); you’ll receive your parking pass when you arrive at camp.</li><li>If you purchase your parking pass at camp, the cost will be $70 (note: NO credit cards accepted at that time).</li></ul>" }
        },
        "campers": {
            "ui:title": "Camper Information",
            "ui:help": "(click the blue + symbol to add additional campers' names)",
            "items": {
                "age": {
                    "ui:help": "If registrant is under 18 please note age here."
                },
                "session": {
                    "ui:description": { "__html": "<p><u>Full camp</u> begins Friday, July 31, 2020 at 3:00 pm, and ends Saturday, August 8 at 9:00am.<br><u>First half camp</u> begins Friday, July 31, 2020 at 3:00 pm and ends before noon on Tuesday, August 4.<br><u>Second half camp</u> begins at noon on Tuesday, August 4, 2020 and ends August 8 at 9:00 am.</p><p>You may either pay a 50% deposit or your full registration fee.</p><ul><li>Full camp (adult): $784 ($764 discount price)</li><li>Full camp (11 and under): $596 ($576 discount price)</li><li>Half camp (adult): $596 ($586 discount price)</li><li>Half camp (11 and under): $484 ($474 discount price)</li></ul>" }
                },
                "accomodations": {
                    "cabinmates": {
                        "ui:description": "Let us know and we will try to accommodate your request."
                    },
                    "tenting_area_preference": {
                        "ui:description": { "__html": "<p>Fill in your tenting preference below. To see a map of camp click on the links to open another window. Area A-C are in <a href='http://www.larkcamp.org/giffiles/campgraphics/camp1.gif' target='_blank'>Camp One</a>, D-H are in <a href='http://www.larkcamp.org/giffiles/campgraphics/camp2.gif' target='_blank'>Camp Two</a>, I-L are in <a href='http://www.larkcamp.org/giffiles/campgraphics/camp3.gif' target='_blank'>Camp Three</a></p>" }
                    }
                },
                "meals": {
                    "ui:description": { "__html": "<p>Meal plans must be paid in full (we cannot accept partial payments) NO LATER THAN JUNE 20, 2020. Food prices include sales tax. You may buy individual meals (at a higher rate!) at camp if you would prefer not to purchase a full meal plan. (NOTE: You may only cook if you have a vehicle with a built-in kitchen. No white gas or propane stoves are allowed in the State Park.)</p><p>This is a significant savings over buying meals at camp.</p><p><strong>Meal Plan Pricing (adult / child 11 and under)</strong></p><ul><li>Full camp, all meals (breakfast, lunch &amp; dinner) $405 adults / $304 kids</li><li>Full camp, just dinners: $221 adults / $162 kids</li><li>Half camp, all meals: $215 adults / $154 kids</li> </ul>" }
                }
            }
        },
        "comments": {
            "ui:widget": "textarea",
            "ui:options": {
              "rows": 5
            }
        },
        "tshirt_sizes": {
            "contentClassNames": "row",
            "small":  { "classNames": "col-xs-4 col-sm-2", "ui:widget": "NaturalNumberInput"},
            "medium": { "classNames": "col-xs-4 col-sm-2", "ui:widget": "NaturalNumberInput" },
            "large":  { "classNames": "col-xs-4 col-sm-2", "ui:widget": "NaturalNumberInput" },
            "xl":     { "classNames": "col-xs-4 col-sm-2", "ui:widget": "NaturalNumberInput" },
            "xxl":    { "classNames": "col-xs-4 col-sm-2", "ui:widget": "NaturalNumberInput" },
            "ui:description": { "__html": "<p>All sizes $14. Price includes sales tax.<br><a href='https://www.larkcamp.org/shirt.html' target='_blank'>More Information About Lark Camp Shirts</a></p><p>T-shirts are standard boxy cut; if you want a fitted t-shirt, let us know in the comments box below.</p>" }
        },
        "sweatshirt_sizes": {
            "contentClassNames": "row",
            "small":  { "classNames": "col-xs-4 col-sm-2", "ui:widget": "NaturalNumberInput" },
            "medium": { "classNames": "col-xs-4 col-sm-2", "ui:widget": "NaturalNumberInput" },
            "large":  { "classNames": "col-xs-4 col-sm-2", "ui:widget": "NaturalNumberInput" },
            "xl":     { "classNames": "col-xs-4 col-sm-2", "ui:widget": "NaturalNumberInput" },
            "xxl":    { "classNames": "col-xs-4 col-sm-2", "ui:widget": "NaturalNumberInput" },
            "ui:description": { "__html": "<p>All sizes $22.</p>" }
        },
        "lta_donation": {
            "ui:description": { "__html": "<p><strong>DONATE TO LARK CAMP</strong><br>Lark Traditional Arts (EIN 83-2424940) is the nonprofit organization that runs Lark Camp. If you would like to support camp with a tax-deductible donation in addition to your registration today, please use the space below to add the amount. Or you may go to: <a href='https://www.larkcamp.org/'>https://www.larkcamp.org/</a></p>" }
        },
        "woodlands_donation": {
            "ui:help": "This does not go to Lark Camp but benefits the Mendocino Woodlands",
            "ui:widget": "NaturalNumberInput"
        }
    },
    "dataSchema": {
        "definitions": {
            "camping_preference": {
                "type": "string",
                "enum": ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L"]
            },
            "natural": {
                "type": "integer",
                "minimum": 0,
                "default": 0
            },
            "shirt_count": {
                "type": "integer",
                "minimum": 0,
                "maximum": 9,
                "default": 0
            },
            "sizes": {
                "type": "object",
                "title": "Sizes",
                "properties": {
                    "small": { "$ref": "#/definitions/shirt_count" },
                    "medium": { "$ref": "#/definitions/shirt_count" },
                    "large": { "$ref": "#/definitions/shirt_count" },
                    "xl": { "$ref": "#/definitions/shirt_count" },
                    "xxl": { "$ref": "#/definitions/shirt_count" }
                }
            },
            "address": {
                "type": "object",
                "title": "Address",
                "properties": {
                    "street_address": {
                        "type": "string",
                        "maxLength": 50,
                        "title": "Address"
                    },
                    "city": {
                        "type": "string",
                        "maxLength": 50,
                        "title": "City"
                    },
                    "state_or_province": {
                        "type": "string",
                        "maxLength": 50,
                        "title": "State or Province"
                    },
                    "zip_code":     {
                        "type": "string",
                        "minLength": 3,
                        "maxLength": 10,
                        "title": "Zipcode or Postal Code"
                    },
                    "country": {
                        "type": "string",
                        "title": "Country",
                        "enum": [ "Afghanistan", "Åland Islands", "Albania", "Algeria", "American Samoa", "Andorra", "Angola", "Anguilla", "Antarctica", "Antigua and Barbuda", "Argentina", "Armenia", "Aruba", "Australia", "Austria", "Azerbaijan", "Bahamas", "Bahrain", "Bangladesh", "Barbados", "Belarus", "Belgium", "Belize", "Benin", "Bermuda", "Bhutan", "Bolivia", "Bosnia and Herzegovina", "Botswana", "Bouvet Island", "Brazil", "British Indian Ocean Territory", "Brunei Darussalam", "Bulgaria", "Burkina Faso", "Burundi", "Cambodia", "Cameroon", "Canada", "Cape Verde", "Cayman Islands", "Central African Republic", "Chad", "Chile", "China", "Christmas Island", "Cocos (Keeling) Islands", "Colombia", "Comoros", "Congo", "Congo, The Democratic Republic of the", "Cook Islands", "Costa Rica", "Côte_d'Ivoire", "Croatia", "Cuba", "Cyprus", "Czech Republic", "Denmark", "Djibouti", "Dominica", "Dominican Republic", "Ecuador", "Egypt", "El Salvador", "Equatorial Guinea", "Eritrea", "Estonia", "Ethiopia", "Falkland Islands (Malvinas)", "Faroe Islands", "Fiji", "Finland", "France", "French Guiana", "French Polynesia", "French Southern Territories", "Gabon", "Gambia", "Georgia", "Germany", "Ghana", "Gibraltar", "Greece", "Greenland", "Grenada", "Guadeloupe", "Guam", "Guatemala", "Guernsey", "Guinea", "Guinea-bissau", "Guyana", "Haiti", "Heard Island and Mcdonald Islands", "Holy See (Vatican City State)", "Honduras", "Hong Kong", "Hungary", "Iceland", "India", "Indonesia", "Iran, Islamic Republic of", "Iraq", "Ireland", "Isle of Man", "Israel", "Italy", "Jamaica", "Japan", "Jersey", "Jordan", "Kazakhstan", "Kenya", "Kiribati", "Korea, Democratic People's Republic of", "Korea, Republic of", "Kuwait", "Kyrgyzstan", "Lao People's Democratic Republic", "Latvia", "Lebanon", "Lesotho", "Liberia", "Libyan Arab Jamahiriya", "Liechtenstein", "Lithuania", "Luxembourg", "Macao", "Macedonia, The Former Yugoslav Republic of", "Madagascar", "Malawi", "Malaysia", "Maldives", "Mali", "Malta", "Marshall Islands", "Martinique", "Mauritania", "Mauritius", "Mayotte", "Mexico", "Micronesia, Federated States of", "Moldova, Republic of", "Monaco", "Mongolia", "Montenegro", "Montserrat", "Morocco", "Mozambique", "Myanmar", "Namibia", "Nauru", "Nepal", "Netherlands", "Netherlands Antilles", "New Caledonia", "New Zealand", "Nicaragua", "Niger", "Nigeria", "Niue", "Norfolk Island", "Northern Mariana Islands", "Norway", "Oman", "Pakistan", "Palau", "Palestinian Territory", "Panama", "Papua New Guinea", "Paraguay", "Peru", "Philippines", "Pitcairn", "Poland", "Portugal", "Puerto Rico", "Qatar", "Reunion", "Romania", "Russian Federation", "Rwanda", "Saint Barthélemy", "Saint Helena", "Saint Kitts and Nevis", "Saint Lucia", "Saint Martin", "Saint Pierre and Miquelon", "Saint Vincent and the Grenadines", "Samoa", "San Marino", "Sao Tome and Principe", "Saudi Arabia", "Senegal", "Serbia", "Seychelles", "Sierra Leone", "Singapore", "Slovakia", "Slovenia", "Solomon Islands", "Somalia", "South Africa", "South Georgia and the South Sandwich Islands", "Spain", "Sri Lanka", "Sudan", "Suriname", "Svalbard and Jan Mayen", "Swaziland", "Sweden", "Switzerland", "Syrian Arab Republic", "Taiwan, Republic of China", "Tajikistan", "Tanzania, United Republic of", "Thailand", "Timor-leste", "Togo", "Tokelau", "Tonga", "Trinidad and Tobago", "Tunisia", "Turkey", "Turkmenistan", "Turks and Caicos Islands", "Tuvalu", "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "United States", "United States Minor Outlying Islands", "Uruguay", "Uzbekistan", "Vanuatu", "Venezuela", "Vietnam", "Virgin Islands, British", "Virgin Islands, U.S.", "Wallis and Futuna", "Western Sahara", "Yemen", "Zambia", "Zimbabwe" ],
                        "default": "United States"
                    }
                },
                "required": ["street_address", "city", "state_or_province", "zip_code", "country"]
            },
            "accomodations": {
                "type": "object",
                "title": "Accomodations",
                "properties": {
                    "camp_preference": {
                        "type": "string",
                        "title": "Camp Preference",
                        "enum": ["Camp 1", "Camp 2", "Camp 3"]
                    },
                    "accomodation_preference": {
                        "type": "string",
                        "title": "Accomodation Preference",
                        "enum": ["Cabin", "Tent", "Vehicle Camping"]
                    }
                },
                "dependencies": {
                    "accomodation_preference": {
                        "oneOf": [
                            {
                                "properties": {
                                    "accomodation_preference": {
                                        "enum": ["Cabin"]
                                    },
                                    "cabinmates": {
                                        "type": "array",
                                        "title": "Who would you like to be in a cabin with? (if in a cabin)",
                                        "items": {
                                            "type": "string",
                                            "maxLength": 50,
                                            "title": "Camper Name"
                                        }
                                    }
                                }
                            },
                            {
                                "properties": {
                                    "accomodation_preference": {
                                        "enum": ["Tent"]
                                    },
                                    "tent_or_vehicle_mates": {
                                        "type": "array",
                                        "title": "Who will be in your tent/vehicle with you?",
                                        "items": {
                                            "type": "string",
                                            "maxLength": 50,
                                            "title": "Name"
                                        }
                                    },
                                    "tenting_area_preference": {
                                        "type": "object",
                                        "title": "What are your tent area preferences, in order?",
                                        "properties": {
                                            "first_choice": {
                                                "$ref": "#/definitions/camping_preference",
                                                "title": "First choice spot"
                                            },
                                            "second_choice": {
                                                "$ref": "#/definitions/camping_preference",
                                                "title": "Second choice spot"
                                            },
                                            "third_choice": {
                                                "$ref": "#/definitions/camping_preference",
                                                "title": "Third choice spot"
                                            },
                                            "fourth_choice": {
                                                "$ref": "#/definitions/camping_preference",
                                                "title": "Fourth choice spot"
                                            }
                                        }
                                    }
                                }
                            },
                            {
                                "properties": {
                                    "accomodation_preference": {
                                        "enum": ["Vehicle Camping"]
                                    },
                                    "tent_or_vehicle_mates": {
                                        "type": "array",
                                        "title": "Who will be in your tent/vehicle with you? (if in a vehicle or tent)",
                                        "items": {
                                            "type": "string",
                                            "maxLength": 50,
                                            "title": "Name"
                                        }
                                    }
                                }
                            }
                        ]
                    }
                }
            },
            "meals": {
                "type": "object",
                "title": "Meal Plans",
                "properties": {
                    "meal_plan": {
                        "type": "string",
                        "title": "What meals will you purchase?",
                        "enum": [
                            "None",
                            "Full Camp, All Meals",
                            "Full Camp, Just Dinners",
                            "Half Camp (first half), All Meals",
                            "Half Camp (second half), All Meals"
                        ]
                    }
                },
                "dependencies": {
                    "meal_plan": {
                        "oneOf": [
                            {
                                "properties": {
                                    "meal_plan": {
                                        "enum": ["None"]
                                    }
                                }
                            },
                            {
                                "properties": {
                                    "meal_plan": {
                                        "enum": [
                                            "Full Camp, All Meals",
                                            "Full Camp, Just Dinners",
                                            "Half Camp (first half), All Meals",
                                            "Half Camp (second half), All Meals"
                                        ]
                                    },
                                    "meal_type": {
                                        "type": "string",
                                        "title": "What types of meals do you want?",
                                        "enum": [
                                            "Non-Vegetarian",
                                            "Vegetarian",
                                            "Vegan"
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                }
            }
        },
        "title": "Lark Camp Registration",
        "type": "object",
        "required": ["payer_first_name", "payer_last_name", "payer_email", "payer_number", "payment_type"],
        "properties": {
            "payer_first_name": {
                "type": "string",
                "maxLength": 50,
                "title": "Billing First Name"
            },
            "payer_last_name": {
                "type": "string",
                "maxLength": 50,
                "title": "Billing Last Name"
            },
            "payer_billing_address": { 
                "$ref": "#/definitions/address"
            },
            "payer_email": {
                "type": "string",
                "format": "email",
                "title": "Email"
            },
            "payer_number": {
                "type": "string",
                "maxLength": 20,
                "pattern": "^\\+[0-9]+$",
                "title": "Phone Number"
            },
            "payment_type": {
                "type": "string",
                "title": "Payment Type",
                "enum": [
                    "Credit Card",
                    "Paypal",
                    "Check"
                ]
            },
            "campers": {
                "title": "Campers",
                "type": "array",
                "minItems": 1,
                "maxItems": 8,
                "items": {
                    "type": "object",
                    "required": ["first_name", "last_name"],
                    "properties": {
                        "first_name": {
                            "type": "string",
                            "maxLength": 50,
                            "title": "First name"
                        },
                        "last_name": {
                            "type": "string",
                            "maxLength": 50,
                            "title": "Last name"
                        },
                        "gender": {
                            "type": "string",
                            "title": "Gender",
                            "enum": ["Male", "Female", "Other"]
                        },
                        "age": {
                            "type": "integer",
                            "minimum": 0,
                            "maximum": 100,
                            "title": "Age, if under 18"
                        },
                        "camper_address": { 
                            "$ref": "#/definitions/address"
                        },
                        "session": {
                            "type": "string",
                            "title": "When will you attend?",
                            "enum": [
                                "Full camp",
                                "Half camp (1st half)",
                                "Half camp (2nd half)"
                            ]
                        },
                        "accomodations": {
                            "$ref": "#/definitions/accomodations"
                        },
                        "meals": {
                            "$ref": "#/definitions/meals"
                        }
                    }
                }
            },
            "parking_passes": {
                "type": "array",
                "title": "Parking Passes",
                "minItems": 0,
                "maxItems": 4,
                "items": {
                    "type": "object",
                    "title": "Parking Pass",
                    "properties": {
                        "holder": {
                            "type": "string",
                            "maxLength": 50,
                            "title": "Whose name will the parking pass be in?"
                        }
                    }
                }
            },
            "tshirt_sizes": {
                "$ref": "#/definitions/sizes",
                "title": "T-shirt Sizes"
            },
            "sweatshirt_sizes": {
                "$ref": "#/definitions/sizes",
                "title": "Sweatshirt Sizes"
            },
            "lta_donation": {
                "type": "integer",
                "minimum": 0,
                "title": "Donation to Lark Traditional Arts (Tax Deductible, Dollars)"
            },
            "how_did_you_hear": {
                "type": "string",
                "maxLength": 50,
                "title": "How did you hear about Lark Camp?"
            },
            "comments": {
                "type": "string",
                "maxLength": 500,
                "title": "Comments"
            }
        }
    },
    "pricingLogic": {
        "+": [
            {"reduce": [
                {"var": "campers"},
                {"+":[
                    {"var": "accumulator"},
                    { "if": [{ ">": [{"var": ["current.age", 18]}, 11]}, 
                        { "+": [
                            { "if": [
                                { "===": ["Full camp", {"var": "current.session"}]}, 784,
                                { "===": ["Half camp (1st half)", {"var": "current.session"}]}, 596,
                                { "===": ["Half camp (2nd half)", {"var": "current.session"}]}, 596,
                                0
                            ]},
                            { "if": [
                                { "===": ["None", {"var": "current.meals.meal_plan"}]}, 0,
                                { "===": ["Full Camp, All Meals", {"var": "current.meals.meal_plan"}]}, 405,
                                { "===": ["Full Camp, Just Dinners", {"var": "current.meals.meal_plan"}]}, 221,
                                { "===": ["Half Camp (first half), All Meals", {"var": "current.meals.meal_plan"}]}, 215,
                                { "===": ["Half Camp (second half), All Meals", {"var": "current.meals.meal_plan"}]}, 215,
                                0
                            ]}
                        ]},
                        { "+": [
                            { "if": [
                                { ">": [{"var": ["current.age", 18]}, 3]},
                                {  "if": [
                                    { "===": ["Full camp", {"var": "current.session"}]}, 596,
                                    { "===": ["Half camp (1st half)", {"var": "current.session"}]}, 484,
                                    { "===": ["Half camp (2nd half)", {"var": "current.session"}]}, 484,
                                    0
                                ]},
                                0
                            ]},
                            { "if": [
                                { "===": ["None", {"var": "current.meals.meal_plan"}]}, 0,
                                { "===": ["Full Camp, All Meals", {"var": "current.meals.meal_plan"}]}, 304,
                                { "===": ["Full Camp, Just Dinners", {"var": "current.meals.meal_plan"}]}, 162,
                                { "===": ["Half Camp (first half), All Meals", {"var": "current.meals.meal_plan"}]}, 154,
                                { "===": ["Half Camp (second half), All Meals", {"var": "current.meals.meal_plan"}]}, 154,
                                0
                            ]}
                        ]}
                    ]}
                ]},
                0
            ]},
            { "if": [
                { "===": [
                    { "var": "payment_type" },
                    "Check"
                ]},
                {"reduce": [
                    {"var": "campers"},
                    {"+":[
                        {"var": "accumulator"},
                        {  "if": [
                            { "===": ["Full camp", {"var": "current.session"}]}, -20,
                            { "===": ["Half camp (1st half)", {"var": "current.session"}]}, -10,
                            { "===": ["Half camp (2nd half)", {"var": "current.session"}]}, -10,
                            0
                        ]}
                    ]},
                    0
                ]},
                0
            ]},
            {"reduce": [
                {"var": "parking_passes"},
                {"+":[
                    {"var": "accumulator"},
                    62
                ]},
                0
            ]},
            {"*": [{"var": ["tshirt_sizes.small", 0]}, 14]},
            {"*": [{"var": ["tshirt_sizes.medium", 0]}, 14]},
            {"*": [{"var": ["tshirt_sizes.large", 0]}, 14]},
            {"*": [{"var": ["tshirt_sizes.xl", 0]}, 14]},
            {"*": [{"var": ["tshirt_sizes.xxl", 0]}, 14]},
            {"*": [{"var": ["sweatshirt_sizes.small", 0]}, 22]},
            {"*": [{"var": ["sweatshirt_sizes.medium", 0]}, 22]},
            {"*": [{"var": ["sweatshirt_sizes.large", 0]}, 22]},
            {"*": [{"var": ["sweatshirt_sizes.xl", 0]}, 22]},
            {"*": [{"var": ["sweatshirt_sizes.xxl", 0]}, 22]},
            {"var": ["lta_donation", 0]},
            {"var": ["woodlands_donation", 0]}
        ]
    }
}
